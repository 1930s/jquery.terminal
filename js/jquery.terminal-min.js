/*

 |       __ _____                     ________                              __
 |      / // _  /__ __ _____ ___ __ _/__  ___/__ ___ ______ __ __  __ ___  / /
 |  __ / // // // // // _  // _// // / / // _  // _//     // //  \/ // _ \/ /
 | /  / // // // // // ___// / / // / / // ___// / / / / // // /\  // // / /__
 | \___//____ \\___//____//_/ _\_  / /_//____//_/ /_/ /_//_//_/ /_/ \__\_\___/
 |           \/              /____/                              version 0.7.1
 http://terminal.jcubic.pl

 Licensed under GNU LGPL Version 3 license
 Copyright (c) 2011-2013 Jakub Jankiewicz <http://jcubic.pl>

 Includes:

 Storage plugin Distributed under the MIT License
 Copyright (c) 2010 Dave Schindler

 jQuery Timers licenced with the WTFPL
 <http://jquery.offput.ca/every/>

 Cross-Browser Split 1.1.1
 Copyright 2007-2012 Steven Levithan <stevenlevithan.com>
 Available under the MIT License

 Date: Tue, 16 Jul 2013 21:00:50 +0000
*/
(function(f,I){function ia(b,d){var h;if(typeof b==="string"&&typeof d==="string"){localStorage[b]=d;return true}else if(typeof b==="object"&&typeof d==="undefined"){for(h in b)if(b.hasOwnProperty(h))localStorage[h]=b[h];return true}return false}function ca(b,d){var h,e;h=new Date;h.setTime(h.getTime()+31536E6);h="; expires="+h.toGMTString();if(typeof b==="string"&&typeof d==="string"){document.cookie=b+"="+d+h+"; path=/";return true}else if(typeof b==="object"&&typeof d==="undefined"){for(e in b)if(b.hasOwnProperty(e))document.cookie=
e+"="+b[e]+h+"; path=/";return true}return false}function ja(b){return localStorage[b]}function ka(b){var d,h,e;b+="=";d=document.cookie.split(";");for(h=0;h<d.length;h++){for(e=d[h];e.charAt(0)===" ";)e=e.substring(1,e.length);if(e.indexOf(b)===0)return e.substring(b.length,e.length)}return null}function la(b){return delete localStorage[b]}function ma(b){return ca(b,"",-1)}function Z(b,d){var h=[],e=b.length;if(e<d)return[b];for(var i=0;i<e;i+=d)h.push(b.substring(i,i+d));return h}function na(b){var d=
b?[b]:[];f.extend(this,{size:function(){return d.length},pop:function(){if(d.length===0)return null;else{var h=d[d.length-1];d=d.slice(0,d.length-1);return h}},push:function(h){d=d.concat([h]);return h},top:function(){return d.length>0?d[d.length-1]:null}})}function oa(b,d){var h=true;if(typeof b==="string"&&b!=="")b+="_";var e=f.Storage.get(b+"commands");e=e?(new Function("return "+e+";"))():[];var i=e.length-1;f.extend(this,{append:function(p){if(h)if(e[e.length-1]!==p){e.push(p);i=e.length-1;if(d&&
e.length>d)e=e.slice(-d);f.Storage.set(b+"commands",f.json_stringify(e))}},data:function(){return e},next:function(){i<e.length-1&&++i;if(i!==-1)return e[i]},reset:function(){i=e.length-1},last:function(){return e[length-1]},end:function(){return i===e.length-1},position:function(){return i},previous:function(){var p=i;i>0&&--i;if(p!==-1)return e[p]},clear:function(){e=[];f.Storage.remove(b+"commands")},enable:function(){h=true},purge:function(){f.Storage.remove(b+"commands")},disable:function(){h=
false}})}function $(b,d){var h=b.split(/( +)/);return{name:h[0],args:d(h.slice(2).join(""))}}function da(b){return typeof settings.processArguments==="function"?$(b,settings.processArguments):settings.processArguments?f.terminal.parseCommand(b):f.terminal.splitCommand(b)}function ea(b,d){var h=1,e=function(i,p){d.pause();f.jrpc(b,h++,i,p,function(t){if(t.error)d.error("&#91;RPC&#93; "+t.error.message);else if(typeof t.result==="string")d.echo(t.result);else if(t.result instanceof Array)d.echo(f.map(t.result,
function(k){return f.json_stringify(k)}).join(" "));else typeof t.result==="object"&&d.echo(f.json_stringify(t.result));d.resume()},function(t,k){k!=="abort"&&d.error("&#91;AJAX&#93; "+k+" - Server reponse is: \n"+t.responseText);d.resume()})};return function(i,p){if(i!==""){i=da(i);if(!settings.login||method==="help")e(i.name,i.args);else{var t=p.token();t?e(i.name,[t].concat(i.args)):p.error("&#91;AUTH&#93; Access denied (no token)")}}}}function aa(b){return function(d,h){if(d!==""){d=da(d);var e=
b[d.name],i=f.type(e);if(i==="function")return e.apply(self,d.args);else if(i==="object"||i==="string"){var p=[];if(i==="object"){for(var t in e)e.hasOwnProperty(t)&&p.push(t);e=aa(e)}h.push(e,{prompt:d.name+"> ",name:d.name,completion:i==="object"?function(k,B,x){x(p)}:I})}else h.error("Command '"+d.name+"' Not Found")}}}function fa(b){var d=b.find(".cursor").width(),h=Math.floor(b.width()/d);if(X(b)){b=b.innerWidth()-b.width();h-=Math.ceil((20-b/2)/(d-1))}return h}function X(b){return b.get(0).scrollHeight>
b.innerHeight()}f.omap=function(b,d){var h={};f.each(b,function(e,i){h[e]=d.call(b,e,i)});return h};var U=typeof window.localStorage!=="undefined";f.extend({Storage:{set:U?ia:ca,get:U?ja:ka,remove:U?la:ma}});jQuery.fn.extend({everyTime:function(b,d,h,e,i){return this.each(function(){jQuery.timer.add(this,b,d,h,e,i)})},oneTime:function(b,d,h){return this.each(function(){jQuery.timer.add(this,b,d,h,1)})},stopTime:function(b,d){return this.each(function(){jQuery.timer.remove(this,b,d)})}});jQuery.extend({timer:{guid:1,
global:{},regex:/^([0-9]+)\s*(.*s)?$/,powers:{ms:1,cs:10,ds:100,s:1E3,das:1E4,hs:1E5,ks:1E6},timeParse:function(b){if(b===I||b===null)return null;var d=this.regex.exec(jQuery.trim(b.toString()));return d[2]?parseInt(d[1],10)*(this.powers[d[2]]||1):b},add:function(b,d,h,e,i,p){var t=0;if(jQuery.isFunction(h)){i||(i=e);e=h;h=d}d=jQuery.timer.timeParse(d);if(!(typeof d!=="number"||isNaN(d)||d<=0)){if(i&&i.constructor!==Number){p=!!i;i=0}i=i||0;p=p||false;if(!b.$timers)b.$timers={};b.$timers[h]||(b.$timers[h]=
{});e.$timerID=e.$timerID||this.guid++;var k=function(){if(!(p&&k.inProgress)){k.inProgress=true;if(++t>i&&i!==0||e.call(b,t)===false)jQuery.timer.remove(b,h,e);k.inProgress=false}};k.$timerID=e.$timerID;b.$timers[h][e.$timerID]||(b.$timers[h][e.$timerID]=window.setInterval(k,d));this.global[h]||(this.global[h]=[]);this.global[h].push(b)}},remove:function(b,d,h){var e=b.$timers,i;if(e){if(d){if(e[d]){if(h){if(h.$timerID){window.clearInterval(e[d][h.$timerID]);delete e[d][h.$timerID]}}else for(var p in e[d])if(e[d].hasOwnProperty(p)){window.clearInterval(e[d][p]);
delete e[d][p]}for(i in e[d])if(e[d].hasOwnProperty(i))break;if(!i){i=null;delete e[d]}}}else for(var t in e)e.hasOwnProperty(t)&&this.remove(b,t,h);for(i in e)if(e.hasOwnProperty(i))break;if(!i)b.$timers=null}}}});if(jQuery.browser&&jQuery.browser.msie||/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase()))jQuery(window).one("unload",function(){var b=jQuery.timer.global,d;for(d in b)if(b.hasOwnProperty(d))for(var h=b[d],e=h.length;--e;)jQuery.timer.remove(h[e],d)});(function(b){if(String.prototype.split.toString().match(/\[native/)){var d=
String.prototype.split,h=/()??/.exec("")[1]===b,e;e=function(i,p,t){if(Object.prototype.toString.call(p)!=="[object RegExp]")return d.call(i,p,t);var k=[],B=(p.ignoreCase?"i":"")+(p.multiline?"m":"")+(p.extended?"x":"")+(p.sticky?"y":""),x=0,w,y,C;p=RegExp(p.source,B+"g");i+="";h||(w=RegExp("^"+p.source+"$(?!\\s)",B));for(t=t===b?4294967295:t>>>0;y=p.exec(i);){B=y.index+y[0].length;if(B>x){k.push(i.slice(x,y.index));!h&&y.length>1&&y[0].replace(w,function(){for(var G=1;G<arguments.length-2;G++)if(arguments[G]===
b)y[G]=b});y.length>1&&y.index<i.length&&Array.prototype.push.apply(k,y.slice(1));C=y[0].length;x=B;if(k.length>=t)break}p.lastIndex===y.index&&p.lastIndex++}if(x===i.length){if(C||!p.test(""))k.push("")}else k.push(i.slice(x));return k.length>t?k.slice(0,t):k};String.prototype.split=function(i,p){return e(this,i,p)};return e}})();f.json_stringify=function(b,d){var h="",e;d=d===I?1:d;switch(typeof b){case "function":h+=b;break;case "boolean":h+=b?"true":"false";break;case "object":if(b===null)h+=
"null";else if(b instanceof Array){h+="[";var i=b.length;for(e=0;e<i-1;++e)h+=f.json_stringify(b[e],d+1);h+=f.json_stringify(b[i-1],d+1)+"]"}else{h+="{";for(i in b)if(b.hasOwnProperty(i))h+='"'+i+'":'+f.json_stringify(b[i],d+1);h+="}"}break;case "string":i=b;var p={"\\\\":"\\\\",'"':'\\"',"/":"\\/","\\n":"\\n","\\r":"\\r","\\t":"\\t"};for(e in p)if(p.hasOwnProperty(e))i=i.replace(RegExp(e,"g"),p[e]);h+='"'+i+'"';break;case "number":h+=String(b)}h+=d>1?",":"";if(d===1)h=h.replace(/,([\]}])/g,"$1");
return h.replace(/([\[{]),/g,"$1")};f.fn.cmd=function(b){function d(){L.toggleClass("inverted")}function h(){F="(reverse-i-search)`"+G+"': ";m()}function e(g){var v=J.data(),M=v.length;if(g&&c>0)M-=c;if(G.length>0)for(var A=G.length;A>0;A--){g=RegExp("^"+G.substring(0,A));for(var u=M;u--;)if(g.test(v[u])){c=v.length-u;n=0;k.set(v[u],true);E();if(G.length!==A){G=G.substring(0,A);h()}return}}}function i(g){var v=g.substring(0,w-y);g=g.substring(w-y);return[v].concat(Z(g,w))}function p(){x.focus();k.oneTime(1,
function(){k.insert(x.val());x.blur().val("")})}function t(g){if(typeof b.keydown=="function"){var v=b.keydown(g);if(v!==I)return v}if(K){if(C&&(g.which===35||g.which===36||g.which===37||g.which===38||g.which===39||g.which===40||g.which===13||g.which===27)){F=z;C=false;c=null;G="";m();if(g.which===27)o="";E();t.call(this,g)}else if(g.altKey){if(g.which===68){k.set(o.slice(0,n)+o.slice(n).replace(/[^ ]+ |[^ ]+$/,""),true);return false}return true}else if(g.keyCode===13){if(J&&o&&(b.historyFilter&&
b.historyFilter(o)||!b.historyFilter))J.append(o);g=o;J.reset();k.set("");b.commands&&b.commands(g);typeof F==="function"&&m()}else if(g.which===8)if(C){G=G.slice(0,-1);h()}else{if(o!==""&&n>0){o=o.slice(0,n-1)+o.slice(n,o.length);--n;E()}}else if(g.which===9&&!(g.ctrlKey||g.altKey))k.insert("\t");else if(g.which===46){if(o!==""&&n<o.length){o=o.slice(0,n)+o.slice(n+1,o.length);E()}return true}else if(J&&g.which===38||g.which===80&&g.ctrlKey){if(J.end())T=o;k.set(J.previous())}else if(J&&g.which===
40||g.which===78&&g.ctrlKey)k.set(J.end()?T:J.next());else if(g.which===37||g.which===66&&g.ctrlKey)if(g.ctrlKey&&g.which!==66){v=n-1;g=0;for(o[v]===" "&&--v;v>0;--v)if(o[v]===" "&&o[v+1]!==" "){g=v+1;break}else if(o[v]==="\n"&&o[v+1]!=="\n"){g=v;break}k.position(g)}else{if(n>0){--n;E()}}else if(g.which===82&&g.ctrlKey)if(C)e(true);else{z=F;h();T=o;o="";E();C=true}else if(g.which==71&&g.ctrlKey){if(C){F=z;m();o=T;E();C=false}}else if(g.which===39||g.which===70&&g.ctrlKey)if(g.ctrlKey&&g.which!==70){o[n]===
" "&&++n;g=o.slice(n).match(/\S[\n\s]{2,}|[\n\s]+\S?/);if(!g||g[0].match(/^\s+$/))n=o.length;else if(g[0][0]!==" ")n+=g.index+1;else{n+=g.index+g[0].length-1;g[0][g[0].length-1]!==" "&&--n}E()}else{if(n<o.length){++n;E()}}else if(g.which===123)return true;else if(g.which===36)k.position(0);else if(g.which===35)k.position(o.length);else if(g.shiftKey&&g.which==45){p();return true}else if(g.ctrlKey||g.metaKey){if(g.which===192)return true;if(g.metaKey)if(g.which===82)return true;else if(g.which===76)return true;
if(g.shiftKey){if(g.which===84)return true}else if(g.which===87){if(o!==""){g=o.slice(0,n);v=o.slice(n+1);var M=g.match(/([^ ]+ *$)/);n=g.length-M[0].length;o=g.slice(0,n)+v;E()}}else if(g.which===72){if(o!==""&&n>0){o=o.slice(0,--n);if(n<o.length-1)o+=o.slice(n);E()}}else if(g.which===65)k.position(0);else if(g.which===69)k.position(o.length);else if(g.which===88||g.which===67||g.which===84)return true;else if(g.which===86){p();return true}else if(g.which===75)if(n===0)k.set("");else n!==o.length&&
k.set(o.slice(0,n));else if(g.which===85){k.set(o.slice(n,o.length));k.position(0)}}else return true;return false}}var k=this,B=k.data("cmd");if(B)return B;k.addClass("cmd");k.append('<span class="prompt"></span><span></span><span class="cursor">&nbsp;</span><span></span>');var x=f("<textarea/>").addClass("clipboard").appendTo(k);b.width&&k.width(b.width);var w,y,C=false,G="",c=null,z,Q=b.mask||false,o="",n=0,F,K=b.enabled,O=b.historySize||60,V,J,L=k.find(".cursor"),E=function(g){function v(l,s){if(s===
l.length){a.html(f.terminal.encode(l));L.html("&nbsp;");j.html("")}else if(s===0){a.html("");L.html(f.terminal.encode(l.slice(0,1)));j.html(f.terminal.encode(l.slice(1)))}else{var q=f.terminal.encode(l.slice(0,s));a.html(q);q=l.slice(s,s+1);L.html(q===" "?"&nbsp;":f.terminal.encode(q));s===l.length-1?j.html(""):j.html(f.terminal.encode(l.slice(s+1)))}}function M(l){return"<div>"+f.terminal.encode(l)+"</div>"}function A(l){var s=j;f.each(l,function(q,r){s=f(M(r)).insertAfter(s).addClass("clear")})}
function u(l){f.each(l,function(s,q){a.before(M(q))})}var a=L.prev(),j=L.next();return function(){var l=Q?o.replace(/./g,"*"):o,s,q;g.find("div").remove();a.html("");if(l.length>w-y-1||l.match(/\n/)){var r,H=l.match(/\t/g),N=H?H.length*3:0;if(H)l=l.replace(/\t/g,"\u0000\u0000\u0000\u0000");if(l.match(/\n/)){var D=l.split("\n");q=w-y-1;for(s=0;s<D.length-1;++s)D[s]+=" ";if(D[0].length>q){r=[D[0].substring(0,q)];r=r.concat(Z(D[0].substring(q),w))}else r=[D[0]];for(s=1;s<D.length;++s)if(D[s].length>
w)r=r.concat(Z(D[s],w));else r.push(D[s])}else r=i(l);if(H)r=f.map(r,function(pa){return pa.replace(/\x00\x00\x00\x00/g,"\t")});q=r[0].length;if(!(q===0&&r.length===1))if(n<q){v(r[0],n);A(r.slice(1))}else if(n===q){a.before(M(r[0]));v(r[1],0);A(r.slice(2))}else{s=r.length;if(n<q){v(r[0],n);A(r.slice(1))}else if(n===q){a.before(M(r[0]));v(r[1],0);A(r.slice(2))}else{H=r.slice(-1)[0];D=l.length-n;var S=H.length;l=0;if(D<=S){u(r.slice(0,-1));v(H,(S===D?0:S-D)+N)}else if(s===3){a.before("<div>"+f.terminal.encode(r[0])+
"</div>");v(r[1],n-q-1);j.after('<div class="clear">'+f.terminal.encode(r[2])+"</div>")}else{l=n;for(s=0;s<r.length;++s){q=r[s].length;if(l>q)l-=q;else break}q=r[s];N=s;if(l===q.length){l=0;q=r[++N]}v(q,l);u(r.slice(0,N));A(r.slice(N+1))}}}}else if(l===""){a.html("");L.html("&nbsp;");j.html("")}else v(l,n)}}(k),T,m=function(){function g(M){y=f("<div>"+f.terminal.strip(M)+"</div>").text().length;v.html(f.terminal.format(f.terminal.encode(M)))}var v=k.find(".prompt");return function(){switch(typeof F){case "string":g(F);
break;case "function":F(g)}}}(),P=[];f.extend(k,{name:function(g){if(g!==I){V=g;J=new oa(g,O);P.push(J);return k}else return V},purge:function(){for(var g=P.length;g--;)P[g].purge();P=[];return k},history:function(){return J},set:function(g,v){if(g!==I){o=g;if(!v)n=o.length;E();if(typeof b.onCommandChange==="function")b.onCommandChange(o)}return k},insert:function(g,v){if(n===o.length)o+=g;else o=n===0?g+o:o.slice(0,n)+g+o.slice(n);v||(n+=g.length);E();if(typeof b.onCommandChange==="function")b.onCommandChange(o);
return k},get:function(){return o},commands:function(g){if(g){b.commands=g;return k}else return g},destroy:function(){f(document.documentElement||window).unbind(".cmd");k.stopTime("blink",d);k.find(".cursor").next().remove().end().prev().remove().end().remove();k.find(".prompt, .clipboard").remove();k.removeClass("cmd").removeData("cmd");return k},prompt:function(g){if(g===I)return F;else{if(typeof g==="string"||typeof g==="function")F=g;else throw"prompt must be a function or string";m();E();return k}},
position:function(g){if(typeof g==="number"){n=g<0?0:g>o.length?o.length:g;E();return k}else return n},visible:function(){var g=k.visible;return function(){g.apply(k,[]);E();m()}}(),show:function(){var g=k.show;return function(){g.apply(k,[]);E();m()}}(),resize:function(g){if(g)w=g;else{g=k.width();var v=L.innerWidth();w=Math.floor(g/v)}E();return k},enable:function(){if(!K){L.addClass("inverted");k.everyTime(500,"blink",d);K=true}return k},isenabled:function(){return K},disable:function(){if(K){k.stopTime("blink",
d);L.removeClass("inverted");K=false}return k},mask:function(g){if(typeof g==="boolean"){Q=g;E();return k}else return Q}});k.name(b.name||b.prompt||"");F=b.prompt||"> ";m();if(b.enabled===I||b.enabled===true)k.enable();f(document.documentElement||window).bind("keypress.cmd",function(g){var v;if(g.ctrlKey&&g.which===99)return true;if(!C&&typeof b.keypress==="function")v=b.keypress(g);if(v===I||v){if(K)if(f.inArray(g.which,[38,13,0,8])>-1&&g.keyCode!==123&&!(g.which===38&&g.shiftKey))return false;else if(!g.ctrlKey&&
!(g.altKey&&g.which===100)||g.altKey){if(C){G+=String.fromCharCode(g.which);e();h()}else k.insert(String.fromCharCode(g.which));return false}}else return v}).bind("keydown.cmd",t);k.data("cmd",k);return k};var qa=/(\[\[[gbiuso]*;[^;]*;[^\]]*\](?:[^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?)/,ba=/\[\[([gbiuso]*);([^;]*);([^;\]]*;|[^\]]*);?([^;\]]*;|[^\]]*);?([^\]]*)\]([^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?/g;ba=/\[\[([gbiuso]*);([^;]*);([^;\]]*);?([^;\]]*);?([^\]]*)\]([^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?/g;
var ga=/#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})/,ra=/https?:\/\/(?:(?!&[^;]+;)[^\s:"'<>)])+/g,sa=/((([^<>('")[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,})))/g,ha=/('[^']*'|"(\\"|[^"])*"|\/(\\\/|[^\/])*\/|(\\ |[^ ])+|[\w-]+)/g;f.terminal={split_equal:function(b,d){for(var h=/\[\[([gbius]*;[^;]*;[^;\]]*;|[^\]]*;?[^\]]*)\]([^\]]*\\\][^\]]*|[^\]]*|[^\[]*\[[^\]]*)\]?/g,e=/(\[\[[gbius]*;[^;]*;[^\]]*\])/,i=/\[\[[gbius]*;?[^;]*;?[^\]]*\]?$/,
p=false,t=false,k="",B=[],x=b.replace(h,function(F,K,O){F=K.match(/;/g).length;return"[["+K+(F==2?";;":F==3?";":"")+O.replace(/\\\]/g,"&#93;").replace(/\n/g,"\\n")+"]"+O+"]"}).split(/\n/g),w=0,y=x.length;w<y;++w)if(x[w]==="")B.push("");else for(var C=x[w],G=0,c=0,z=0,Q=C.length;z<Q;++z){if(C[z]==="["&&C[z+1]==="[")p=true;else if(p&&C[z]==="]")if(t)t=p=false;else t=true;else if(p&&t||!p)if(C[z]==="&"){var o=C.substring(z).match(/^(&[^;]+;)/);if(!o)throw"Unclosed html entity in line "+(w+1)+" at char "+
(z+1);z+=o[1].length-2;z===Q-1&&B.push(n+o[1]);continue}else if(C[z]==="]"&&C[z-1]==="\\")--c;else++c;if(c===d||z===Q-1){var n=C.substring(G,z+1);if(k){n=k+n;if(n.match("]"))k=""}G=z+1;c=0;if(o=n.match(h)){o=o[o.length-1];if(o[o.length-1]!=="]"){k=o.match(e)[1];n+="]"}else if(n.match(i)){n=n.replace(i,"");k=o.match(e)[1]}}B.push(n)}}return B},encode:function(b){return b.replace(/&(?!#[0-9]+;|[a-zA-Z]+;|[^=]+=)/,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\t/g,
"&nbsp;&nbsp;&nbsp;&nbsp;")},format:function(b){if(typeof b==="string"){var d=b.split(qa);if(d&&d.length>1)b=f.map(d,function(h){return h===""?h:h.substring(0,1)==="["?h.replace(ba,function(e,i,p,t,k,B,x){if(x==="")return"";x=x.replace(/\\]/g,"]");e="";if(i.indexOf("b")!==-1)e+="font-weight:bold;";var w=[];i.indexOf("u")!==-1&&w.push("underline");i.indexOf("s")!==-1&&w.push("line-through");i.indexOf("o")!==-1&&w.push("overline");if(w.length)e+="text-decoration:"+w.join(" ")+";";if(i.indexOf("i")!==
-1)e+="font-style:italic;";if(p.match(ga)){e+="color:"+p+";";if(i.indexOf("g")!==-1)e+="text-shadow:0 0 5px "+p+";"}if(t.match(ga))e+="background-color:"+t;return'<span style="'+e+'"'+(k!==""?' class="'+k+'"':"")+' data-text="'+(B===""?x:B.replace(/&#93;/g,"]")).replace('"',"&quote;")+'">'+x+"</span>"}):"<span>"+h+"</span>"}).join("");return f.map(b.split(/(<\/?span[^>]*>)/g),function(h){return h.match(/span/)?h:h.replace(ra,function(e){var i=e.match(/\.$/);e=e.replace(/\.$/,"");return'<a target="_blank" href="'+
e+'">'+e+"</a>"+(i?".":"")}).replace(sa,'<a href="mailto:$1">$1</a>')}).join("").replace(/<span><br\/?><\/span>/g,"<br/>")}else return""},escape_brackets:function(b){return b.replace(/\[/g,"&#91;").replace(/\]/g,"&#93;")},strip:function(b){return b.replace(ba,"$6")},active:function(){return R.front()},ansi_colors:{normal:{black:"#000",red:"#AA0000",green:"#008400",yellow:"#AA5500",blue:"#0000AA",magenta:"#AA00AA",cyan:"#00AAAA",white:"#AAA"},faited:{black:"#000",red:"#640000",green:"#006100",yellow:"#737300",
blue:"#000087",magenta:"#650065",cyan:"#008787",white:"#818181"},bold:{black:"#000",red:"#FF5555",green:"#44D544",yellow:"#FFFF55",blue:"#5555FF",magenta:"#FF55FF",cyan:"#55FFFF",white:"#FFF"}},from_ansi:function(){function b(e){var i=e.split(";"),p,t=e=false,k=false,B=[],x="",w="",y;for(y in i){p=parseInt(i[y],10);switch(p){case 1:B.push("b");k=true;e=false;break;case 4:B.push("u");break;case 3:B.push("i");break;case 2:e=true;k=false;break;case 7:t=true}if(h[p])w=h[p];if(d[p])x=d[p]}if(t){y=w;w=
x;x=y}x||(x=t?"black":"white");w||(w=t?"white":"black");y=t=f.terminal.ansi_colors.normal;if(k)t=y=f.terminal.ansi_colors.bold;else if(e)t=y=f.terminal.ansi_colors.faited;return"[["+[B.join(""),t[x],y[w]].join(";")+"]"}var d={30:"black",31:"red",32:"green",33:"yellow",34:"blue",35:"magenta",36:"cyan",37:"white"},h={40:"black",41:"red",42:"green",43:"yellow",44:"blue",45:"magenta",46:"cyan",47:"white"};return function(e){var i=e.split(/(\x1B\[[0-9;]*[A-Za-z])/g);if(i.length==1)return e;e=[];if(i.length>
3&&i.slice(0,3).join("")=="[0m")i=i.slice(3);for(var p=false,t=0;t<i.length;++t){var k=i[t].match(/^\x1B\[([0-9;]*)([A-Za-z])$/);if(k)switch(k[2]){case "m":if(k[1]=="")continue;if(p){e.push("]");if(k[1]=="0")p=false;else e.push(b(k[1]))}else{p=true;e.push(b(k[1]))}}else e.push(i[t])}p&&e.push("]");return e.join("")}}(),parseArguments:function(b){return f.map(b.match(ha)||[],function(d){if(d[0]==="'"&&d[d.length-1]==="'")return d.replace(/^'|'$/g,"");else if(d[0]==='"'&&d[d.length-1]==='"'){d=d.replace(/^"|"$/g,
"").replace(/\\([" ])/g,"$1");return d.replace(/\\\\|\\t|\\n/g,function(h){return h[1]==="t"?"\t":h[1]==="n"?"\n":"\\"}).replace(/\\x([0-9a-f]+)/gi,function(h,e){return String.fromCharCode(parseInt(e,16))}).replace(/\\0([0-7]+)/g,function(h,e){return String.fromCharCode(parseInt(e,8))})}else return d[0]==="/"&&d[d.length-1]=="/"?RegExp(d.replace(/^\/|\/$/g,"")):d.match(/^-?[0-9]+$/)?parseInt(d,10):d.match(/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/)?parseFloat(d):d.replace(/\\ /g," ")})},splitArguments:function(b){return f.map(b.match(ha)||
[],function(d){return d[0]==="'"&&d[d.length-1]==="'"?d.replace(/^'|'$/g,""):d[0]==='"'&&d[d.length-1]==='"'?d.replace(/^"|"$/g,"").replace(/\\([" ])/g,"$1"):d[0]==="/"&&d[d.length-1]=="/"?d:d.replace(/\\ /g," ")})},parseCommand:function(b){return $(b,f.terminal.parseArguments)},splitCommand:function(b){return $(b,f.terminal.splitArguments)},test:function(){function b(B,x){d.echo(x+" &#91;"+(B?"[[b;#44D544;]PASS]":"[[b;#FF5555;]FAIL]")+"&#93;")}var d=f("body").terminal().css("margin",0);d.outerHeight();
d.height();f(window).resize(function(){d.css("height",f(window).height()-20)}).resize();d.echo("Testing...");var h='name "foo bar" baz /^asd [x]/ str\\ str 10 1e10',e=f.terminal.splitCommand(h);b(e.name==="name"&&e.args[0]==="foo bar"&&e.args[1]==="baz"&&e.args[2]==="/^asd [x]/"&&e.args[3]==="str str"&&e.args[4]==="10"&&e.args[5]==="1e10","$.terminal.splitCommand");e=f.terminal.parseCommand(h);b(e.name==="name"&&e.args[0]==="foo bar"&&e.args[1]==="baz"&&f.type(e.args[2])==="regexp"&&e.args[2].source===
"^asd [x]"&&e.args[3]==="str str"&&e.args[4]===10&&e.args[5]===1E10,"$.terminal.parseCommand");b(f.terminal.from_ansi("\u001b[2;31;46mFoo\u001b[1;3;4;32;45mBar\u001b[0m\u001b[7mBaz")==="[[;#640000;#008787]Foo][[biu;#44D544;#FF55FF]Bar][[;#000;#AAA]Baz]","$.terminal.from_ansi");h="[[biugs;#fff;#000]Foo][[i;;;foo]Bar][[ous;;]Baz]";d.echo("$.terminal.format");b(f.terminal.format(h)==='<span style="font-weight:bold;text-decoration:underline line-through;font-style:italic;color:#fff;text-shadow:0 0 5px #fff;background-color:#000" data-text="Foo">Foo</span><span style="font-style:italic;" class="foo" data-text="Bar">Bar</span><span style="text-decoration:underline line-through overline;" data-text="Baz">Baz</span>',
"\tformatting");b(f.terminal.format("http://terminal.jcubic.pl/examples.php https://www.google.com/?q=jquery%20terminal")==='<a target="_blank" href="http://terminal.jcubic.pl/examples.php">http://terminal.jcubic.pl/examples.php</a> <a target="_blank" href="https://www.google.com/?q=jquery%20terminal">https://www.google.com/?q=jquery%20terminal</a>',"\turls");b(f.terminal.format("foo@bar.com baz.quux@example.com")==='<a href="mailto:foo@bar.com">foo@bar.com</a> <a href="mailto:baz.quux@example.com">baz.quux@example.com</a>',
"\temails");b(f.terminal.strip("-_-[[biugs;#fff;#000]Foo]-_-[[i;;;foo]Bar]-_-[[ous;;]Baz]-_-")==="-_-Foo-_-Bar-_-Baz-_-","$.terminal.strip");h="[[bui;#fff;]Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sed dolor nisl, in suscipit justo. Donec a enim et est porttitor semper at vitae augue. Proin at nulla at dui mattis mattis. Nam a volutpat ante. Aliquam consequat dui eu sem convallis ullamcorper. Nulla suscipit, massa vitae suscipit ornare, tellus] est [[b;;#f00]consequat nunc, quis blandit elit odio eu arcu. Nam a urna nec nisl varius sodales. Mauris iaculis tincidunt orci id commodo. Aliquam] non magna quis [[i;;]tortor malesuada aliquam] eget ut lacus. Nam ut vestibulum est. Praesent volutpat tellus in eros dapibus elementum. Nam laoreet risus non nulla mollis ac luctus [[ub;#fff;]felis dapibus. Pellentesque mattis elementum augue non sollicitudin. Nullam lobortis fermentum elit ac mollis. Nam ac varius risus. Cras faucibus euismod nulla, ac auctor diam rutrum sit amet. Nulla vel odio erat], ac mattis enim.";
d.echo("$.terminal.split_equal");e=[10,40,60,400];for(var i=e.length;i--;){for(var p=f.terminal.split_equal(h,e[i]),t=true,k=0;k<p.length;++k)if(f.terminal.strip(p[k]).length>e[i]){t=false;break}b(t,"\tsplit "+e[i])}}};f.fn.visible=function(){return this.css("visibility","visible")};f.fn.hidden=function(){return this.css("visibility","hidden")};f.jrpc=function(b,d,h,e,i,p){d=f.json_stringify({jsonrpc:"2.0",method:h,params:e,id:d});return f.ajax({url:b,data:d,success:i,error:p,contentType:"application/json",
dataType:"json",async:true,cache:false,type:"POST"})};U=/ {13}$/;var ta=[["jQuery Terminal","(c) 2011-2013 jcubic"],["jQuery Terminal Emulator v. 0.7.1","(c) 2011-2013 Jakub Jankiewicz <http://jcubic.pl>".replace(/ *<.*>/,"")],["jQuery Terminal Emulator version version 0.7.1","(c) 2011-2013 Jakub Jankiewicz <http://jcubic.pl>"],["      _______                 ________                        __","     / / _  /_ ____________ _/__  ___/______________  _____  / /"," __ / / // / // / _  / _/ // / / / _  / _/     / /  \\/ / _ \\/ /",
"/  / / // / // / ___/ // // / / / ___/ // / / / / /\\  / // / /__","\\___/____ \\\\__/____/_/ \\__ / /_/____/_//_/ /_/ /_/  \\/\\__\\_\\___/","         \\/          /____/                                   ".replace(U,"")+"version 0.7.1","(c) 2011-2013 Jakub Jankiewicz <http://jcubic.pl>"],["      __ _____                     ________                              __","     / // _  /__ __ _____ ___ __ _/__  ___/__ ___ ______ __ __  __ ___  / /"," __ / // // // // // _  // _// // / / // _  // _//     // //  \\/ // _ \\/ /",
"/  / // // // // // ___// / / // / / // ___// / / / / // // /\\  // // / /__","\\___//____ \\\\___//____//_/ _\\_  / /_//____//_/ /_/ /_//_//_/ /_/ \\__\\_\\___/","          \\/              /____/                                          ".replace(U,"")+"version 0.7.1","(c) 2011-2013 Jakub Jankiewicz <http://jcubic.pl>"]];f.terminal.defaults={prompt:"> ",history:true,exit:true,clear:true,enabled:true,historySize:60,displayExceptions:true,cancelableAjax:true,processArguments:true,login:null,outputLimit:-1,
tabcompletion:null,historyFilter:null,onInit:f.noop,onClear:f.noop,onBlur:f.noop,onFocus:f.noop,onTerminalChange:f.noop,onExit:f.noop,keypress:f.noop,keydown:f.noop};var W=[],R=new function(b){var d=b?[b]:[],h=0;f.extend(this,{get:function(){return d},rotate:function(){if(d.length===1)return d[0];else{if(h===d.length-1)h=0;else++h;return d[h]}},length:function(){return d.length},set:function(e){for(var i=d.length;i--;)if(d[i]===e){h=i;return}this.append(e)},front:function(){return d[h]},append:function(e){d.push(e)}})},
Y=[];f.fn.terminal=function(b,d){function h(a,j){if(m.displayExceptions){c.error("&#91;"+j+"&#93;: "+(typeof a==="string"?a:typeof a.fileName==="string"?a.fileName+": "+a.message:a.message));if(typeof a.fileName==="string"){c.pause();f.get(a.fileName,function(l){c.resume();var s=a.lineNumber-1;(l=l.split("\n")[s])&&c.error("&#91;"+a.lineNumber+"&#93;: "+l)})}a.stack&&c.error(a.stack)}}function e(){var a=z.prop?z.prop("scrollHeight"):z.attr("scrollHeight");z.scrollTop(a)}function i(a,j){try{if(typeof j===
"function")j(function(){});else if(typeof j!=="string")throw a+" must be string or function";}catch(l){h(l,a.toUpperCase());return false}return true}function p(a,j){var l=f.extend({raw:false,finalize:f.noop},j||{});a=f.type(a)==="function"?a():a;a=f.type(a)==="string"?a:String(a);var s,q,r;l.raw||(a=f.terminal.encode(a));if(!l.raw&&(a.length>O||a.match(/\n/))){var H=f.terminal.split_equal(f.terminal.from_ansi(a),O);s=f("<div></div>");q=0;for(r=H.length;q<r;++q)if(H[q]===""||H[q]==="\r")s.append("<div>&nbsp;</div>");
else l.raw?f("<div/>").html(H[q]):f("<div/>").html(f.terminal.format(H[q])).appendTo(s)}else{l.raw||(a=f.terminal.format(f.terminal.from_ansi(a)));s=f("<div/>").html("<div>"+a+"</div>")}F.append(s);s.width("100%");l.finalize(s);if(m.outputLimit>=0){l=m.outputLimit===0?c.rows():m.outputLimit;q=F.find("div div");q.length>l&&q.slice(0,q.length-l+1).remove()}e();return s}function t(){if(m.greetings===I)c.echo(c.signature);else m.greetings&&c.echo(m.greetings)}function k(a){a=f.terminal.escape_brackets(f.terminal.encode(a));
var j=u.prompt();if(u.mask())a=a.replace(/./g,"*");typeof j==="function"?j(function(l){c.echo(l+a)}):c.echo(j+a)}function B(a,j){try{Q=a;var l=A.top();if(a==="exit"&&m.exit)if(A.size()===1)if(m.login)w();else{j||k(a);c.echo("You can't exit from main interpeter")}else c.pop("exit");else{j||k(a);var s=n.length-1;if(a==="clear"&&m.clear)c.clear();else{var q=l.eval(a,c);if(q!==I){if(s===n.length-1){n.pop();q!==false&&c.echo(q)}else n=q===false?n.slice(0,s).concat(n.slice(s+1)):n.slice(0,s).concat([q]).concat(n.slice(s+
1));c.resize()}}}}catch(r){h(r,"USER");c.resume();throw r;}}function x(){var a=null;u.prompt("login: ");m.history&&u.history().disable();u.commands(function(j){try{k(j);if(a){u.mask(false);c.pause();if(typeof m.login!=="function")throw"Value of login property must be a function";m.login(a,j,function(s){if(s){var q=m.name;q=(q?q+"_":"")+K+"_";f.Storage.set(q+"token",s);f.Storage.set(q+"login",a);u.commands(B);C()}else{c.error("Wrong password try again");u.prompt("login: ");a=null}c.resume();m.history&&
u.history().enable()},c)}else{a=j;u.prompt("password: ");u.mask(true)}}catch(l){h(l,"LOGIN",c);throw l;}})}function w(){if(typeof m.onBeforelogout==="function")try{if(m.onBeforelogout(c)==false)return}catch(a){h(a,"onBeforelogout");throw a;}var j=(m.name?m.name+"_":"")+K+"_";f.Storage.remove(j+"token");f.Storage.remove(j+"login");m.history&&u.history().disable();x();if(typeof m.onAfterlogout==="function")try{m.onAfterlogout(c)}catch(l){h(l,"onAfterlogout");throw l;}}function y(){var a=A.top(),j=m.name+
"_"+K+(Y.length?"_"+Y.join("_"):"");u.name(j);typeof a.prompt=="function"?u.prompt(function(l){a.prompt(l,c)}):u.prompt(a.prompt);m.history&&u.history().enable();u.set("");if(typeof a.onStart==="function")a.onStart(c)}function C(){y();t();if(typeof m.onInit==="function")try{m.onInit(c)}catch(a){h(a,"OnInit");throw a;}}function G(a){var j=A.top();if(f.type(j.keydown)==="function"){j=j.keydown(a,c);if(j!==I)return j}var l;c.oneTime(10,function(){g()});if(f.type(m.keydown)==="function"){j=m.keydown(a,
c);if(j!==I)return j}if(c.paused()){if(a.which===68&&a.ctrlKey){if(W.length){for(l=W.length;l--;){a=W[l];if(4!==a.readyState)try{a.abort()}catch(s){c.error("error in aborting ajax")}}W=[];c.resume()}return false}}else{if(a.which!==9)o=0;if(a.which===68&&a.ctrlKey){if(u.get()==="")if(A.size()>1||m.login!==I)c.pop("");else{c.resume();c.echo("")}else c.set_command("");return false}else if(m.tabcompletion&&a.which===9){++o;var q=u.get().substring(0,u.position());a=q.split(" ");var r;if(a.length==1)r=
a[0];else{r=a[a.length-1];for(l=a.length-1;l>0;l--)if(a[l-1][a[l-1].length-1]=="\\")r=a[l-1]+" "+r;else break}a=r.replace(/([\^\$\[\]\(\)\+\*\.\|])/g,"\\$1");var H=RegExp("^"+a);A.top().completion(c,r,function(N){if(u.get().substring(0,u.position())===q){var D=[];for(l=N.length;l--;)H.test(N[l])&&D.push(N[l]);if(D.length===1)c.insert(D[0].replace(H,""));else if(D.length>1)if(o>=2){k(q);c.echo(D.join("\t"));o=0}else{N=false;var S=r.length;a:for(;S<D[0].length;++S){for(l=1;l<D.length;++l)if(D[0].charAt(S)!==
D[l].charAt(S))break a;N=true}N&&c.insert(D[0].slice(0,S).replace(H,""))}}});return false}else if(a.which===86&&a.ctrlKey)c.oneTime(1,function(){e()});else if(a.which===9&&a.ctrlKey){if(R.length()>1){c.focus(false);return false}}else if(a.which===34)c.scroll(c.height());else a.which===33?c.scroll(-c.height()):c.attr({scrollTop:c.attr("scrollHeight")})}}if(this.length>1)return this.each(function(){f.fn.terminal.call(f(this),b,f.extend({name:this.selector},d))});else{var c=this;if(c.data("terminal"))return c.data("terminal");
if(c.length===0)throw'Sorry, but terminal said that "'+c.selector+'" is not valid selector!';var z,Q,o=0,n=[],F,K=R.length(),O,V=[],J,L,E,T=[],m=f.extend({name:c.selector},f.terminal.defaults,d||{}),P=!m.enabled;f.extend(c,f.omap({clear:function(){F.html("");u.set("");n=[];try{m.onClear(c)}catch(a){h(a,"onClear");throw a;}c.attr({scrollTop:0});return c},export_view:function(){return{prompt:c.get_prompt(),command:c.get_command(),position:u.position(),lines:n.slice(0)}},import_view:function(a){c.set_prompt(a.prompt);
c.set_command(a.command);u.position(a.position);n=a.lines;c.resize();return c},exec:function(a,j){P?T.push([a,j]):B(a,j);return c},commands:function(){return A.top().eval},greetings:function(){t();return c},paused:function(){return P},pause:function(){if(u){P=true;c.disable();u.hidden()}return c},resume:function(){if(u){c.enable();var a=T;for(T=[];a.length;){var j=a.shift();c.exec.apply(c,j)}u.visible();e()}return c},cols:function(){return O},rows:function(){return Math.floor(c.height()/c.find(".cursor").height())},
history:function(){return u.history()},next:function(){if(R.length()===1)return c;else{var a=c.offset().top;c.height();c.scrollTop();var j=c,l=f(window).scrollTop(),s=l+f(window).height(),q=f(j).offset().top;if(q+f(j).height()>=l&&q<=s){R.front().disable();a=R.rotate().enable();j=a.offset().top-50;f("html,body").animate({scrollTop:j},500);try{m.onTerminalChange(a)}catch(r){h(r,"onTerminalChange");throw r;}return a}else{c.enable();f("html,body").animate({scrollTop:a-50},500);return c}}},focus:function(a,
j){c.oneTime(1,function(){if(R.length()===1)if(a===false)try{!j&&m.onBlur(c)!==false&&c.disable()}catch(l){h(l,"onBlur");throw l;}else try{!j&&m.onFocus(c)!==false&&c.enable()}catch(s){h(s,"onFocus");throw s;}else if(a===false)c.next();else{var q=R.front();if(q!=c){q.disable();if(!j)try{m.onTerminalChange(c)}catch(r){h(r,"onTerminalChange");throw r;}}R.set(c);c.enable()}});return c},enable:function(){O===I&&c.resize();if(P)if(u){u.enable();P=false}return c},disable:function(){if(u){P=true;u.disable()}return c},
enabled:function(){return P},signature:function(){var a=c.cols();a=a<15?null:a<35?0:a<55?1:a<64?2:a<75?3:4;return a!==null?ta[a].join("\n")+"\n":""},version:function(){return"0.7.1"},get_command:function(){return u.get()},insert:function(a){if(typeof a==="string"){u.insert(a);return c}else throw"insert function argument is not a string";},set_prompt:function(a){if(i("prompt",a)){typeof a=="function"?u.prompt(function(j){a(j,c)}):u.prompt(a);A.top().prompt=a}return c},get_prompt:function(){return A.top().prompt},
set_command:function(a){u.set(a);return c},set_mask:function(a){u.mask(a);return c},get_output:function(a){return a?n:f.map(n,function(j){return typeof j[0]=="function"?j[0]():j[0]}).join("\n")},resize:function(a,j){if(a&&j){c.width(a);c.height(j)}a=c.width();j=c.height();O=fa(c);u.resize(O);var l=F.empty().detach();f.each(n,function(s,q){p.apply(null,q)});u.before(l);e();if(typeof m.onResize==="function"&&(E!==j||L!==a))m.onResize(c);if(E!==j||L!==a){E=j;L=a}return c},echo:function(a,j){var l=f.extend({raw:false,
finalize:f.noop},j||{});n.push([a,l]);p(a,l);g();return c},error:function(a,j){return c.echo("[[;#f00;]"+f.terminal.escape_brackets(a).replace(/\\$/,"&#92;")+"]",j)},scroll:function(a){var j;a=Math.round(a);if(z.prop){a>z.prop("scrollTop")&&a>0&&z.prop("scrollTop",0);j=z.prop("scrollTop")}else{a>z.attr("scrollTop")&&a>0&&z.attr("scrollTop",0);j=z.attr("scrollTop")}z.scrollTop(j+a);return c},logout:m.login?function(){for(;A.size()>1;)A.pop();w();return c}:function(){throw"You don't have login function";
},token:m.login?function(){var a=m.name;return f.Storage.get((a?a+"_":"")+K+"_token")}:f.noop,login_name:m.login?function(){var a=m.name;return f.Storage.get((a?a+"_":"")+K+"_login")}:f.noop,name:function(){return A.top().name},push:function(a,j){if(j&&(!j.prompt||i("prompt",j.prompt))||!j){j=j||{};j.name=j.name||Q;j.prompt=j.prompt||j.name+" ";Y.push(j.name);A.top().mask=u.mask();var l=typeof a;if(l==="string")a=ea(a,c);else if(l==="object"){var s=[],q;for(q in a)s.push(q);a=aa(a);j=j||{};j.completion=
function(r,H,N){N(s)}}else if(l!=="function")throw"Invalid value as eval in push command";A.push(f.extend({eval:a},j));y()}return c},pop:function(a){a!==I&&k(a);Y.pop();if(A.top().name===m.name){if(m.login){w();if(f.type(m.onExit)==="function")try{m.onExit(c)}catch(j){h(j,"onExit");throw j;}}}else{a=A.pop();y();if(f.type(a.onExit)==="function")try{a.onExit(c)}catch(l){h(l,"onExit");throw l;}c.set_mask(A.top().mask)}return c},level:function(){return A.size()},reset:function(){for(c.clear();A.size()>
1;)A.pop();C();return c},purge:function(){u.purge();var a=(m.name?m.name+"_":"")+K+"_";f.Storage.remove(a+"token");f.Storage.remove(a+"login");return c},destroy:function(){u.destroy().remove();F.remove();f(document).unbind(".terminal");f(window).unbind(".terminal");c.unbind("click, mousewheel");c.removeData("terminal").removeClass("terminal");m.width&&c.css("width","");m.height&&c.css("height","");return c}},function(a,j){return function(){try{return j.apply(this,Array.prototype.slice.apply(arguments))}catch(l){a!==
"exec"&&h(l,"TERMINAL")}}}));var g=function(){var a=X(c);return function(){if(a!==X(c)){c.resize();a=X(c)}}}();m.width&&c.width(m.width);m.height&&c.height(m.height);z=!navigator.userAgent.toLowerCase().match(/(webkit)[ \/]([\w.]+)/)&&c[0].tagName.toLowerCase()=="body"?f("html"):c;f(document).bind("ajaxSend.terminal",function(a,j){W.push(j)});F=f("<div>").addClass("terminal-output").appendTo(c);c.addClass("terminal");if("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch){c.click(function(){c.find("textarea").focus()});
c.find("textarea").focus()}if(m.login&&f.type(m.onBeforeLogin)==="function")try{m.onBeforeLogin(c)}catch(v){h(v,"onBeforeLogin");throw v;}if(f.type(b)==="string"){J=b;b=ea(b,c)}else if(f.type(b)==="array")throw"You can't use array as eval";else if(f.type(b)==="object"){for(var M in b)b.hasOwnProperty(M)&&V.push(M);b=aa(b)}else if(f.type(b)==="undefined")b=f.noop;else if(f.type(b)!=="function")throw'Unknow object "'+String(b)+'" passed as eval';if(J&&(f.type(m.login)==="string"||m.login))m.login=function(a){var j=
1;return function(l,s,q){c.pause();f.jrpc(J,j++,a,[l,s],function(r){c.resume();!r.error&&r.result?q(r.result):q(null)},function(r,H){c.resume();c.error("&#91;AJAX&#92; Response: "+H+"\n"+r.responseText)})}}(f.type(m.login)==="boolean"?"login":m.login);if(i("prompt",m.prompt)){var A=new na({name:m.name,eval:b,prompt:m.prompt,completion:m.completion?m.completion:function(a,j,l){l(V)},greetings:m.greetings}),u=f("<div/>").appendTo(c).cmd({prompt:m.prompt,history:m.history,historyFilter:m.historyFilter,
historySize:m.historySize,width:"100%",keydown:G,keypress:m.keypress?function(a){return m.keypress(a,c)}:null,onCommandChange:function(a){if(f.type(m.onCommandChange)==="function")try{m.onCommandChange(a,c)}catch(j){h(j,"onCommandChange");throw j;}e()},commands:B});O=fa(c);R.append(c);m.enabled===true?c.focus(I,true):c.disable();f(document).bind("click.terminal",function(a){!f(a.target).parents().hasClass("terminal")&&m.onBlur(c)!==false&&c.disable()});f(window).bind("resize.terminal",function(){if(c.is(":visible")){var a=
c.width(),j=c.height();if(E!==j||L!==a)c.resize()}});c.click(function(){c.focus()});m.login&&c.token&&!c.token()&&c.login_name&&!c.login_name()?x():C();f.type(f.fn.init.prototype.mousewheel)==="function"&&c.mousewheel(function(a,j){j>0?c.scroll(-40):c.scroll(40);return false},true)}c.data("terminal",c);return c}}})(jQuery);
